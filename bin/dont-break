#!/usr/bin/env node

var dontBreak = require('../src/dont-break');
var osTmpdir = require('os-tmpdir');

console.assert(!module.parent, 'why are you using me from another module?');

var join = require('path').join;
var pkg = require(join(__dirname, '..', 'package.json'));
console.log(pkg.name + '@' + pkg.version, '-', pkg.description);

var options = require('../src/cli-options');

options.tmpDir = osTmpdir();

dontBreak(options)
  .then(stats => {
    if (stats.failures > 0) {
      throw new Error('failed');
    }
  })
  .catch(err => {
    console.log(err.toString());
    process.exit(1);
  });
